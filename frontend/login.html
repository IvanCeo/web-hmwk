<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Вход — Ламповый магазин</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gradient-to-br from-gray-900 to-gray-700 min-h-screen text-white font-sans">

  <!-- Навигация -->
  <nav class="bg-gray-800 px-6 py-4 flex justify-between items-center shadow-xl">
    <div class="flex items-center gap-3">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="36" height="36" class="text-cyan-400 drop-shadow">
        <path d="M12 .75a8.25 8.25 0 0 0-4.135 15.39c.686.398 1.115 1.008 1.134 1.623a.75.75 0 0 0 .577.706c.352.083.71.148 1.074.195.323.041.6-.218.6-.544v-4.661a6.714 6.714 0 0 1-.937-.171.75.75 0 1 1 .374-1.453 5.261 5.261 0 0 0 2.626 0 .75.75 0 1 1 .374 1.452 6.712 6.712 0 0 1-.937.172v4.66c0 .327.277.586.6.545.364-.047.722-.112 1.074-.195a.75.75 0 0 0 .577-.706c.02-.615.448-1.225 1.134-1.623A8.25 8.25 0 0 0 12 .75Z"/>
        <path fill-rule="evenodd" clip-rule="evenodd" d="M9.013 19.9a.75.75 0 0 1 .877-.597 11.319 11.319 0 0 0 4.22 0 .75.75 0 1 1 .28 1.473 12.819 12.819 0 0 1-4.78 0 .75.75 0 0 1-.597-.876ZM9.754 22.344a.75.75 0 0 1 .824-.668 13.682 13.682 0 0 0 2.844 0 .75.75 0 1 1 .156 1.492 15.156 15.156 0 0 1-3.156 0 .75.75 0 0 1-.668-.824Z"/>
      </svg>
      <span class="text-2xl font-bold tracking-wide">ЛамповыйЗавод</span>
    </div>
    <div class="flex gap-4 items-center">
      <a href="index.html" class="hover:text-cyan-400 transition">Каталог</a>
      <a href="contacts.html" class="hover:text-cyan-400 transition">Контакты</a>
      <a href="order.html" class="hover:text-cyan-400 transition">Заказ</a>
      <a href="login.html" class="ml-4 px-4 py-1 bg-cyan-400 text-gray-900 rounded-lg font-bold hover:bg-cyan-300 transition">Вход</a>
    </div>
  </nav>

  <!-- Контент -->
  <main class="container mx-auto px-4 md:px-0 mt-20 flex justify-center">
    <div class="w-full max-w-md bg-gray-800 rounded-2xl shadow-2xl p-8 border border-gray-700">
      <h1 class="text-3xl font-extrabold mb-8 text-center text-cyan-400 drop-shadow-lg">Вход в личный кабинет</h1>
      <form id="login-form" class="flex flex-col gap-6">
        <div>
          <label for="username" class="block mb-2 text-gray-300">Имя пользователя</label>
          <input id="username" name="username" type="text" required autocomplete="username"
            class="w-full px-4 py-2 rounded-lg bg-gray-900 border border-gray-700 focus:border-cyan-400 focus:outline-none text-white" />
        </div>
        <div>
          <label for="password" class="block mb-2 text-gray-300">Пароль</label>
          <input id="password" name="password" type="password" required autocomplete="current-password"
            class="w-full px-4 py-2 rounded-lg bg-gray-900 border border-gray-700 focus:border-cyan-400 focus:outline-none text-white" />
        </div>
        <button type="submit"
          class="w-full py-3 mt-2 bg-cyan-400 text-gray-900 font-bold rounded-lg hover:bg-cyan-300 transition">Войти</button>
        <div id="login-error" class="hidden text-red-500 text-center mt-2"></div>
      </form>
    </div>
  </main>

  <!-- Футер -->
  <footer class="mt-12 p-4 bg-gray-900 text-center text-sm text-gray-400 rounded-t-2xl shadow-inner">
    2025 © Ламповый завод — фабрика по производству ламп различного назначения.
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  <script>
    document.getElementById('login-form').addEventListener('submit', async function(e) {
      e.preventDefault();
      const username = document.getElementById('username').value.trim();
      const password = document.getElementById('password').value.trim();
      const errorDiv = document.getElementById('login-error');
      errorDiv.classList.add('hidden');
      errorDiv.textContent = '';

      try {
        // Используем URLSearchParams для form-data!
        const params = new URLSearchParams();
        params.append('username', username);
        params.append('password', password);

        const res = await axios.post('/api/v1/admin/login', params, {
          headers: {
            'Content-Type': 'application/x-www-form-urlencoded'
          }
        });
        if (res.data.access_token) {
          localStorage.setItem('token', res.data.access_token);
          window.location.href = 'admin.html'; // стало
        }
      } catch (err) {
        errorDiv.textContent = 'Неверное имя пользователя или пароль!';
        errorDiv.classList.remove('hidden');
      }
    });
  </script>
</body>
</html>
